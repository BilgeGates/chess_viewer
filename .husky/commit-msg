#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "Validating commit message..."

# Run commitlint
npx --no -- commitlint --edit "$1"

# Check if there are any errors
if [ $? -ne 0 ]; then
  echo ""
  echo "Commit message does not follow Conventional Commits format!"
  echo ""
  echo "Commit message format:"
  echo "   <type>(<scope>): <subject>"
  echo ""
  echo "Types:"
  echo "   feat:     A new feature"
  echo "   fix:      A bug fix"
  echo "   docs:     Documentation only changes"
  echo "   style:    Code style changes (formatting, missing semi colons, etc)"
  echo "   refactor: Code refactoring"
  echo "   perf:     Performance improvements"
  echo "   test:     Adding or updating tests"
  echo "   chore:    Changes to build process or auxiliary tools"
  echo "   ci:       CI configuration changes"
  echo "   build:    Changes that affect the build system"
  echo ""
  echo "Examples:"
  echo "   feat: add SVG export support"
  echo "   feat(export): add batch export functionality"
  echo "   fix: resolve piece rendering issue in Safari"
  echo "   docs: update README with new features"
  echo "   style: format code with prettier"
  echo ""
  exit 1
fi

echo "Commit message is valid!"